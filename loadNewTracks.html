<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <link rel="stylesheet" href="custom.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-inverse">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" href="changeInfo.html">Orientifty</a>
                </div>
                <ul class="nav navbar-nav">
                    <li><a href="changeInfo.html">Load new tracks</a></li>
                    <li><a href="availableTracks.html">Available tracks</a></li>
                    <li class="active"><a href="loadNewTracks.html">How to load new tracks</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    
                    <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Log out</a></li>
                </ul>
            </div>
        </nav>
        <div class="container">
            <!-- Trigger the modal with a button -->
            <button type="button" class="btn btn-success btn-lg" data-toggle="modal" data-target="#myModal">Kaart</button><br>
            <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal1">1.Checkpoint</button>
            <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal2">2.Checkpoint</button>
            <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal3">3.Checkpoint</button>
            <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal4">4.Checkpoint</button>

            <!-- Modal -->
            <div class="modal fade" id="myModal" role="dialog">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Basic track info</h4>
                        </div>
                        <div class="modal-body">
                            <input type="text" id="rada" placeholder="Track name" class="form-control">
                            <input type="text" id="linn" placeholder="City where track is located" class="form-control">
                            <input type="text" id="kaart" placeholder="Map name example:track.png" class="form-control">
                            <input type="text" id="length" placeholder="Distance of track" class="form-control">
                            <br>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Save</button>
                        </div>
                    </div>

                </div>
            </div>

            <div class="modal fade" id="myModal1" role="dialog">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Checkpoint 1</h4>
                        </div>
                        <div class="modal-body">
                            <input type="text" id="checkpoints1" placeholder="Checkpoint1" class="form-control">
                            <input type="text" id="answer1" placeholder="Right answer, example:A" class="form-control">
                            <input type="text" id="choice1" placeholder="Choices, example: 3" class="form-control">
                            <input type="text" id="time1" placeholder="Time:true,false" class="form-control"><br>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Save</button>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal fade" id="myModal2" role="dialog">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Checkpoint 2</h4>
                        </div>
                        <div class="modal-body">
                            <input type="text" id="checkpoints2" placeholder="Checkpoint2" class="form-control">
                            <input type="text" id="answer2" placeholder="Answer" class="form-control">
                            <input type="text" id="choice2" placeholder="Choice" class="form-control">
                            <input type="text" id="time2" placeholder="Time" class="form-control"><br>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Save</button>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal fade" id="myModal3" role="dialog">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Checkpoint 3</h4>
                        </div>
                        <div class="modal-body">
                            <input type="text" id="checkpoints3" placeholder="Checkpoint3" class="form-control">
                            <input type="text" id="answer3" placeholder="Answer" class="form-control">
                            <input type="text" id="choice3" placeholder="Choice" class="form-control">
                            <input type="text" id="time3" placeholder="Time" class="form-control"><br>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Save</button>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal fade" id="myModal4" role="dialog">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Checkpont 4</h4>
                        </div>
                        <div class="modal-body">
                            <input type="text" id="checkpoints4" placeholder="Checkpoint4" class="form-control">
                            <input type="text" id="answer4" placeholder="Answer" class="form-control">
                            <input type="text" id="choice4" placeholder="Choice" class="form-control">
                            <input type="text" id="time4" placeholder="Time" class="form-control"><br>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Save</button>
                        </div>
                    </div>

                </div>
            </div>

        </div>
        <p>Lae Ã¼les kaart:</p>
        <input type="file" value="upload" id="fileButton" class="btn btn-default btn-file" />

        <script src="https://www.gstatic.com/firebasejs/3.8.0/firebase.js"></script>
        <script>
            // Initialize Firebase
            var config = {
                apiKey: "AIzaSyALh9SrPLPXUJuRW2dVtR_dKVvQXDhmRS0",
                authDomain: "suva-6c5b6.firebaseapp.com",
                databaseURL: "https://suva-6c5b6.firebaseio.com",
                projectId: "suva-6c5b6",
                storageBucket: "suva-6c5b6.appspot.com",
                messagingSenderId: "69179275064"
            };
            firebase.initializeApp(config);
            console.log("ssd");
            firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                    console.log("signed in");
                } else {
                    //window.location = "https://orientify.github.io/index.html";
                }});
        </script>

        <script>
            var provider = new firebase.auth.GoogleAuthProvider();
            function signInToGoogle() {
                firebase.auth().signInWithRedirect(provider);
            };
            function signOutFromGoogle() {
                firebase.auth().signOut().then(function() {
                    // Sign-out successful.
                }).catch(function(error) {
                    // An error happened.
                }); 
            }
        </script>

        <script>
            var uploader = document.getElementById('uploader');
            var fileButton = document.getElementById('fileButton');

            fileButton.addEventListener('change', function(e){
                var file = e.target.files[0];

                var storageRef = firebase.storage().ref('maps/' + file.name);

                var task = storageRef.put(file);

                task.on('state_changed',
                        function progress(snapshot) {
                    var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                    uploader.value = percentage;
                },
                        function error(err){

                },
                        function complete(){

                }
                       );
            });
        </script>
        <script>
            function writeTrackInfo() {
                var rada = document.getElementById('rada').value;
                var linn = document.getElementById('linn').value;
                var kaart = document.getElementById('kaart').value;

                var checkpoints = [];
                var answer = [];
                var choice = [];
                var time = [];
                for(var i = 1; i < 5; i++){
                    checkpoints[i] = document.getElementById('checkpoints' + i).value;
                    answer[i] = document.getElementById('answer' + i).value;
                    choice[i] = document.getElementById('choice' + i).value;
                    time[i] = document.getElementById('time' + i).value;
                }

                if(rada.length >0){
                    firebase.database().ref('trackss/' + rada).set({
                        city: linn,
                        map: kaart
                    });
                    for(var i = 1; i < 5; i++){
                        console.log('trackss/' + rada + '/checkpoints/' + checkpoints[i]);
                        firebase.database().ref('trackss/' + rada + '/checkpoints/' + checkpoints[i]).set({
                            answer: answer[i],
                            choice: choice[i],
                            time: time[i]
                        });
                    }
                }
            }

        </script>
        <button onclick="writeTrackInfo()" class="btn btn-success">Insert track</button>
        <button onclick="readDataFromFire()" class="btn btn-success">test</button><br>
        <button onclick="signOutFromGoogle()" class="btn btn-danger">Sign out</button>

        <table id="myTable">
            <tr>
                <th>City</th>
                <th>Name of track</th>
            </tr>
        </table>
        <script>
            $(document).ready(function() {
                // Call horizontalNav on the navigations wrapping element
                $('.full-width').horizontalNav({});
            });

        </script>





    </body>
</html>