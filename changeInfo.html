<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="custom.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
    
    <progress value="0" max="100" id="uploader">0%</progress>
    <input type="file" value="upload" id="fileButton"/>
    
    <script src="https://www.gstatic.com/firebasejs/3.8.0/firebase.js"></script>
        <script>
          // Initialize Firebase
          var config = {
            apiKey: "AIzaSyALh9SrPLPXUJuRW2dVtR_dKVvQXDhmRS0",
            authDomain: "suva-6c5b6.firebaseapp.com",
            databaseURL: "https://suva-6c5b6.firebaseio.com",
            projectId: "suva-6c5b6",
            storageBucket: "suva-6c5b6.appspot.com",
            messagingSenderId: "69179275064"
          };
          firebase.initializeApp(config);
            console.log("ssd");
            firebase.auth().onAuthStateChanged(function(user) {
              if (user) {
                  console.log("signed in");
              } else {
                window.location = "https://orientify.github.io/index.html";
              }});
        </script>
    
    <script>
        var provider = new firebase.auth.GoogleAuthProvider();
        function signInToGoogle() {
            firebase.auth().signInWithRedirect(provider);
            };
        function signOutFromGoogle() {
            firebase.auth().signOut().then(function() {
              // Sign-out successful.
            }).catch(function(error) {
              // An error happened.
            }); 
        }
    </script>
    
    <script>
        var uploader = document.getElementById('uploader');
        var fileButton = document.getElementById('fileButton');
        
        fileButton.addEventListener('change', function(e){
            var file = e.target.files[0];
            
            var storageRef = firebase.storage().ref('maps/' + file.name);
            
            var task = storageRef.put(file);
            
            task.on('state_changed',
                   function progress(snapshot) {
                        var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                        uploader.value = percentage;
            },
                function error(err){
                
            },
                function complete(){
                
            }
               );
        });
    </script>
  
    <button onclick="writeTrackInfo()">Insert track</button>
    <input type="text" id="rada" placeholder="Track name" required>
    <input type="text" id="linn" placeholder="City" required>
    <input type="text" id="kaart" placeholder="Map" required><br>
    
    <input type="text" id="checkpoints1" placeholder="Checkpoint1" required>
    <input type="text" id="answer1" placeholder="Answer" required>
    <input type="text" id="choice1" placeholder="Choice" required>
    <input type="text" id="time1" placeholder="Time" required><br>
    
    <input type="text" id="checkpoints2" placeholder="Checkpoint2" required>
    <input type="text" id="answer2" placeholder="Answer" required>
    <input type="text" id="choice2" placeholder="Choice" required>
    <input type="text" id="time2" placeholder="Time" required><br>
    
    <input type="text" id="checkpoints3" placeholder="Checkpoint3" required>
    <input type="text" id="answer3" placeholder="Answer" required>
    <input type="text" id="choice3" placeholder="Choice" required>
    <input type="text" id="time3" placeholder="Time" required><br>
    
    <input type="text" id="checkpoints4" placeholder="Checkpoint4" required>
    <input type="text" id="answer4" placeholder="Answer" required>
    <input type="text" id="choice4" placeholder="Choice" required>
    <input type="text" id="time4" placeholder="Time" required><br>
    <script>
        function writeTrackInfo() {
            var rada = document.getElementById('rada').value;
            var linn = document.getElementById('linn').value;
            var kaart = document.getElementById('kaart').value;
            var checkpoints = document.getElementById('checkpoints1').value;
            var answer = document.getElementById('answer').value;
            var choice = document.getElementById('choice').value;
            var time = document.getElementById('time').value;
            if(rada.length >0){
                firebase.database().ref('trackss/' + rada).set({
                city: linn,
                map: kaart
              });
                firebase.database().ref('trackss/' + rada + '/checkpoints/' + checkpoints1).set({
                answer1: answer1,
                choice1: choice1,
                time1: time1
                });
                
                firebase.database().ref('trackss/' + rada + '/checkpoints/' + checkpoints2).set({
                answer2: answer2,
                choice2: choice2,
                time2: time2
                });
                
                firebase.database().ref('trackss/' + rada + '/checkpoints/' + checkpoints3).set({
                answer3: answer3,
                choice3: choice3,
                time3: time3
                });
                
                firebase.database().ref('trackss/' + rada + '/checkpoints/' + checkpoints4.set({
                answer4: answer4,
                choice4: choice4,
                time4: time4
                });
            }
        }
    </script>
    
    <button onclick="signInToGoogle()">Sign in</button><br>
    <button onclick="signOutFromGoogle()">Sign out</button>
    




</body>
</html>