<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="custom.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
    <h1>Uue kaardi laadimise leht</h1>
<body>
   <div class="container">
  <!-- Trigger the modal with a button -->
  <button type="button" class="btn btn-success btn-lg" data-toggle="modal" data-target="#myModal">Kaart</button><br>
  <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal1">1.Checkpoint</button>
  <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal2">2.Checkpoint</button>
  <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal3">3.Checkpoint</button>
  <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal4">4.Checkpoint</button>

  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <div class="modal-body">
            <input type="text" id="rada" placeholder="Track name" class="form-control">
            <input type="text" id="linn" placeholder="City" class="form-control">
            <input type="text" id="kaart" placeholder="Map" class="form-control"><br>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
       
<div class="modal fade" id="myModal1" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <div class="modal-body">
          <input type="text" id="checkpoints1" placeholder="Checkpoint1" class="form-control">
            <input type="text" id="answer1" placeholder="Answer" class="form-control">
            <input type="text" id="choice1" placeholder="Choice" class="form-control">
            <input type="text" id="time1" placeholder="Time" class="form-control"><br>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
<div class="modal fade" id="myModal2" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <div class="modal-body">
            <input type="text" id="checkpoints2" placeholder="Checkpoint2" class="form-control">
            <input type="text" id="answer2" placeholder="Answer" class="form-control">
            <input type="text" id="choice2" placeholder="Choice" class="form-control">
            <input type="text" id="time2" placeholder="Time" class="form-control"><br>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
<div class="modal fade" id="myModal3" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <div class="modal-body">
          <input type="text" id="checkpoints3" placeholder="Checkpoint3" class="form-control">
        <input type="text" id="answer3" placeholder="Answer" class="form-control">
        <input type="text" id="choice3" placeholder="Choice" class="form-control">
        <input type="text" id="time3" placeholder="Time" class="form-control"><br>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
<div class="modal fade" id="myModal4" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <div class="modal-body">
          <input type="text" id="checkpoints4" placeholder="Checkpoint4" class="form-control">
        <input type="text" id="answer4" placeholder="Answer" class="form-control">
        <input type="text" id="choice4" placeholder="Choice" class="form-control">
        <input type="text" id="time4" placeholder="Time" class="form-control"><br>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
  
</div>
    <p>Lae Ã¼les kaart:</p>
    <input type="file" value="upload" id="fileButton" class="btn btn-default btn-file" />
  
    <script src="https://www.gstatic.com/firebasejs/3.8.0/firebase.js"></script>
        <script>
          // Initialize Firebase
          var config = {
            apiKey: "AIzaSyALh9SrPLPXUJuRW2dVtR_dKVvQXDhmRS0",
            authDomain: "suva-6c5b6.firebaseapp.com",
            databaseURL: "https://suva-6c5b6.firebaseio.com",
            projectId: "suva-6c5b6",
            storageBucket: "suva-6c5b6.appspot.com",
            messagingSenderId: "69179275064"
          };
          firebase.initializeApp(config);
            console.log("ssd");
            firebase.auth().onAuthStateChanged(function(user) {
              if (user) {
                  console.log("signed in");
              } else {
                //window.location = "https://orientify.github.io/index.html";
              }});
        </script>
    
    <script>
        var provider = new firebase.auth.GoogleAuthProvider();
        function signInToGoogle() {
            firebase.auth().signInWithRedirect(provider);
            };
        function signOutFromGoogle() {
            firebase.auth().signOut().then(function() {
              // Sign-out successful.
            }).catch(function(error) {
              // An error happened.
            }); 
        }
    </script>
    
    <script>
        var uploader = document.getElementById('uploader');
        var fileButton = document.getElementById('fileButton');
        
        fileButton.addEventListener('change', function(e){
            var file = e.target.files[0];
            
            var storageRef = firebase.storage().ref('maps/' + file.name);
            
            var task = storageRef.put(file);
            
            task.on('state_changed',
                   function progress(snapshot) {
                        var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                        uploader.value = percentage;
            },
                function error(err){
                
            },
                function complete(){
                
            }
               );
        });
    </script>

    <button onclick="writeTrackInfo()" class="btn btn-success">Insert track</button><br>
    <script>
        function writeTrackInfo() {
            var rada = document.getElementById('rada').value;
            var linn = document.getElementById('linn').value;
            var kaart = document.getElementById('kaart').value;
            
            var checkpoints1 = document.getElementById('checkpoints1').value;
            var answer1 = document.getElementById('answer1').value;
            var choice1 = document.getElementById('choice1').value;
            var time1 = document.getElementById('time1').value;
            
            var checkpoints2 = document.getElementById('checkpoints2').value;
            var answer2 = document.getElementById('answer2').value;
            var choice2 = document.getElementById('choice2').value;
            var time2 = document.getElementById('time2').value;
            
            var checkpoints3 = document.getElementById('checkpoints3').value;
            var answer3 = document.getElementById('answer3').value;
            var choice3 = document.getElementById('choice3').value;
            var time3 = document.getElementById('time3').value;
            
            if(rada.length >0){
                firebase.database().ref('trackss/' + rada).set({
                city: linn,
                map: kaart
              });
                for(x = 1; x < 4; x++){
                    firebase.database.ref('trackss/' + rada + '/checkpoints/' checkpoints + x).set({
                    answer: answer + x,
                    choice: choice + x,
                    time: time + x
                    });
                }
                
            }
        }
    
    </script>

    <button onclick="signOutFromGoogle()" class="btn btn-danger">Sign out</button>
    




</body>
</html>